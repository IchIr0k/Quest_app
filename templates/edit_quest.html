{% extends "base.html" %}
{% block title %}Редактировать квест{% endblock %}
{% block content %}
<div class="container">
    <h2>Редактировать квест: {{ quest.title }}</h2>

    <form action="/admin/edit/{{ quest.id }}" method="post" enctype="multipart/form-data" class="admin-form">
        <label>Название<br><input type="text" name="title" value="{{ quest.title }}" required></label>

        <label>Описание<br><textarea name="description" rows="4">{{ quest.description }}</textarea></label>

        <label>Жанр<br>
            <div class="checkbox-group">
                {% set current_genres = quest.genre.split(', ') %}
                <label><input type="checkbox" name="genres" value="детям" {% if "детям" in current_genres %}checked{% endif %}> Детям</label><br>
                <label><input type="checkbox" name="genres" value="страшные" {% if "страшные" in current_genres %}checked{% endif %}> Страшные</label><br>
                <label><input type="checkbox" name="genres" value="веселые" {% if "веселые" in current_genres %}checked{% endif %}> Весёлые</label><br>
                <label><input type="checkbox" name="genres" value="с актерами" {% if "с актерами" in current_genres %}checked{% endif %}> С актёрами</label><br>
                <label><input type="checkbox" name="genres" value="без актеров" {% if "без актеров" in current_genres %}checked{% endif %}> Без актёров</label><br>
                <label><input type="checkbox" name="genres" value="нестрашные" {% if "нестрашные" in current_genres %}checked{% endif %}> Нестрашные</label><br>
                <label><input type="checkbox" name="genres" value="загадки" {% if "загадки" in current_genres %}checked{% endif %}> Загадки</label><br>
            </div>
        </label>

        <label>Сложность<br>
            <select name="difficulty" required>
                <option value="легкий" {% if quest.difficulty == "легкий" %}selected{% endif %}>Лёгкий</option>
                <option value="нормальный" {% if quest.difficulty == "нормальный" %}selected{% endif %}>Нормальный</option>
                <option value="сложный" {% if quest.difficulty == "сложный" %}selected{% endif %}>Сложный</option>
                <option value="экстремальный" {% if quest.difficulty == "экстремальный" %}selected{% endif %}>Экстремальный</option>
            </select>
        </label>

        <label>Уровень страха (1-5)<br>
            <input type="number" name="fear_level" min="1" max="5" value="{{ quest.fear_level }}" required>
        </label>

        <label>Максимальное количество игроков<br>
            <input type="number" name="players" min="1" max="6" value="{{ quest.players }}" required>
        </label>

        <label>Текущее изображение:<br>
            {% if quest.image_path %}
            <img src="/static/{{ quest.image_path }}" alt="{{ quest.title }}" style="max-width: 200px; margin: 10px 0;">
            {% else %}
            <span>Нет изображения</span>
            {% endif %}
        </label>

        <label>Новое изображение (оставьте пустым, чтобы сохранить текущее)<br>
            <input type="file" name="image" accept="image/*">
        </label>

        <button type="submit" class="btn">Сохранить изменения</button>
        <a href="/admin" class="btn outline" style="margin-left: 10px;">Отмена</a>
    </form>
</div>

<style>
.admin-form {
  max-width: 600px;
}

.admin-form input,
.admin-form select,
.admin-form textarea {
  width: 100%;
  padding: 10px;
  margin: 5px 0 15px 0;
  border: 1px solid #39417b;
  border-radius: 8px;
  background: #0b1330;
  color: #e6e9fb;
  box-sizing: border-box;
}

.admin-form label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

.admin-form button {
  margin-top: 10px;
}

.checkbox-group {
  background: #0b1330;
  padding: 15px;
  border-radius: 8px;
  border: 1px solid #39417b;
}

.checkbox-group label {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
  font-weight: normal;
}

.checkbox-group input[type="checkbox"] {
  width: auto;
  margin-right: 10px;
}
</style>
{% endblock %}